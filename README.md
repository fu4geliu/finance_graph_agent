# ğŸš€ Graph-Enhanced RAG: Neo4j + MCP

<div align="center">

**åŸºäºå›¾æ•°æ®åº“ä¸å·¥å…·è°ƒç”¨åè®®ï¼ˆMCPï¼‰çš„å¢å¼ºå‹ RAG ç³»ç»Ÿ**

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Neo4j](https://img.shields.io/badge/Neo4j-Graph%20RAG-orange.svg)](https://neo4j.com/)
[![RAG](https://img.shields.io/badge/RAG-Enhanced-brightgreen.svg)](https://en.wikipedia.org/wiki/Retrieval-augmented_generation)

**ä¼ ç»Ÿå‘é‡æ£€ç´¢çš„å±€é™æ€§ï¼Ÿâ†’ å›¾æ£€ç´¢ + å…³ç³»æ¨ç†çš„å¢å¼º RAG**

</div>

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª**å¢å¼ºå‹ RAGï¼ˆRetrieval-Augmented Generationï¼‰ç³»ç»Ÿ**ï¼Œé‡‡ç”¨ **Neo4j å›¾æ•°æ®åº“ + MCPï¼ˆModel Context Protocolï¼‰å·¥å…·è°ƒç”¨åè®®**ï¼Œç›¸æ¯”ä¼ ç»ŸåŸºäºå‘é‡æ•°æ®åº“çš„ RAG æ–¹æ¡ˆï¼Œèƒ½å¤Ÿå®ç°æ›´ç²¾å‡†çš„ä¸Šä¸‹æ–‡æ£€ç´¢å’Œå¤æ‚å…³ç³»æ¨ç†ã€‚

### ğŸ¯ æ ¸å¿ƒåˆ›æ–°ç‚¹

- **ğŸ“Š å›¾æ£€ç´¢æ›¿ä»£å‘é‡æ£€ç´¢**ï¼šä½¿ç”¨ Neo4j å›¾æ•°æ®åº“å­˜å‚¨ç»“æ„åŒ–çŸ¥è¯†ï¼Œæ”¯æŒå…³ç³»æŸ¥è¯¢å’Œå¤šè·³æ¨ç†
- **ğŸ”— å…³ç³»æ„ŸçŸ¥æ£€ç´¢**ï¼šä¸ä»…æ£€ç´¢ç›¸ä¼¼å†…å®¹ï¼Œè¿˜èƒ½å‘ç°å®ä½“é—´çš„å…³è”å…³ç³»å’Œè·¯å¾„
- **ğŸ› ï¸ MCP å·¥å…·è°ƒç”¨åè®®**ï¼šé€šè¿‡æ ‡å‡†åŒ–å·¥å…·æ¥å£ï¼Œè®© LLM èƒ½å¤ŸåŠ¨æ€æŸ¥è¯¢å›¾æ•°æ®åº“
- **ğŸ§  æ™ºèƒ½æ£€ç´¢ç­–ç•¥**ï¼šæ”¯æŒå®ä½“å†å²ã€å…³ç³»è·¯å¾„ã€æ—¶åºæŸ¥è¯¢ç­‰å¤šç§æ£€ç´¢æ¨¡å¼
- **âš¡ å®æ—¶çŸ¥è¯†æ›´æ–°**ï¼šæŒç»­ä»è´¢ç»æ–°é—»ä¸­æŠ½å–äº‹ä»¶ï¼Œæ„å»ºåŠ¨æ€çŸ¥è¯†å›¾è°±

### ğŸ†š å¯¹æ¯”ä¼ ç»Ÿ RAG

| ç‰¹æ€§ | ä¼ ç»Ÿå‘é‡ RAG | æœ¬é¡¹ç›®çš„å›¾å¢å¼º RAG |
|------|------------|-----------------|
| **æ£€ç´¢æ–¹å¼** | è¯­ä¹‰ç›¸ä¼¼åº¦æ£€ç´¢ | å›¾å…³ç³»æ£€ç´¢ + è¯­ä¹‰æ£€ç´¢ |
| **å…³ç³»ç†è§£** | âŒ æ— æ³•ç†è§£å®ä½“å…³ç³» | âœ… æ”¯æŒå¤šè·³å…³ç³»æ¨ç† |
| **æŸ¥è¯¢èƒ½åŠ›** | å…³é”®è¯/è¯­ä¹‰åŒ¹é… | å…³ç³»è·¯å¾„ã€æœ€çŸ­è·¯å¾„ã€æ—¶åºæŸ¥è¯¢ |
| **ç»“æ„åŒ–** | éç»“æ„åŒ–æ–‡æ¡£å— | ç»“æ„åŒ–äº‹ä»¶-å®ä½“-å…³ç³» |
| **å¤æ‚æŸ¥è¯¢** | "A å’Œ B çš„å…³ç³»ï¼Ÿ" âŒ | "A å’Œ B çš„å…³ç³»ï¼Ÿ" âœ… |

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### å¢å¼º RAG æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·æŸ¥è¯¢                              â”‚
â”‚          "å®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LLM (Qwen) + Tool Calling                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ç†è§£æŸ¥è¯¢æ„å›¾ â†’ å†³å®šè°ƒç”¨å“ªä¸ªæ£€ç´¢å·¥å…·            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼ (MCP Tool Call)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Neo4j å›¾æ•°æ®åº“ (æ£€ç´¢å±‚)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Cypher æŸ¥è¯¢:                                  â”‚    â”‚
â”‚  â”‚  MATCH path = shortestPath(                    â”‚    â”‚
â”‚  â”‚    (a:Entity {name:"å®å¾·æ—¶ä»£"})-[*]-(          â”‚    â”‚
â”‚  â”‚    b:Entity {name:"æ¯”äºšè¿ª"})                    â”‚    â”‚
â”‚  â”‚  )                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  (Entity) â”€â”€[ç«äº‰å…³ç³»]â”€â”€> (Entity)                      â”‚
â”‚  å®å¾·æ—¶ä»£                   æ¯”äºšè¿ª                        â”‚
â”‚     â”‚                        â”‚                          â”‚
â”‚     â””â”€[æŠ•èµ„]â”€> (Event) <â”€[æŠ•èµ„]â”€â”˜                      â”‚
â”‚                     â”‚                                   â”‚
â”‚                 é”‚ç”µæ± è¡Œä¸š                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼ (è¿”å›ç»“æ„åŒ–ç»“æœ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LLM ç”Ÿæˆæœ€ç»ˆå›ç­”                            â”‚
â”‚  "å®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªéƒ½æ˜¯é”‚ç”µæ± è¡Œä¸šçš„é¾™å¤´ä¼ä¸šï¼Œ            â”‚
â”‚   å­˜åœ¨ç«äº‰å…³ç³»ï¼ŒåŒæ—¶éƒ½æŠ•èµ„äº†ä¸Šæ¸¸äº§ä¸šé“¾..."               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµå‘

```
éç»“æ„åŒ–æ–°é—»
    â†“ [LLM æŠ½å–]
ç»“æ„åŒ–äº‹ä»¶ (Event + Entity + Relations)
    â†“ [å­˜å‚¨]
Neo4j çŸ¥è¯†å›¾è°±
    â†“ [MCP å·¥å…·æŸ¥è¯¢]
æ£€ç´¢ä¸Šä¸‹æ–‡
    â†“ [æ³¨å…¥ LLM]
å¢å¼ºç”Ÿæˆå›ç­”
```

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯å®ç°

### 1. MCP å·¥å…·å®šä¹‰ï¼ˆæ£€ç´¢ç­–ç•¥ï¼‰

ç³»ç»Ÿå®šä¹‰äº†ä¸‰ç§æ ¸å¿ƒæ£€ç´¢å·¥å…·ï¼Œå¯¹åº”ä¸åŒçš„æŸ¥è¯¢åœºæ™¯ï¼š

#### å·¥å…· 1: æ—¶åºæ£€ç´¢ - `get_latest_market_events`
```python
# è·å–æœ€æ–°çš„å¸‚åœºäº‹ä»¶ï¼ˆæ—¶é—´ç»´åº¦çš„æ£€ç´¢ï¼‰
MATCH (e:Event)
WHERE e.timestamp IS NOT NULL
ORDER BY e.timestamp DESC LIMIT $limit
```
**åº”ç”¨åœºæ™¯**ï¼šå›ç­”"æœ€è¿‘å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"ã€"æœ€æ–°çš„è´¢ç»æ–°é—»ï¼Ÿ"

#### å·¥å…· 2: å®ä½“æ£€ç´¢ - `search_entity_history`
```python
# æŸ¥è¯¢ç‰¹å®šå®ä½“çš„å†å²äº‹ä»¶ï¼ˆå®ä½“ç»´åº¦çš„æ£€ç´¢ï¼‰
MATCH (ent:Entity)-[r:PARTICIPATES_IN]->(e:Event)
WHERE ent.name CONTAINS $name
ORDER BY e.timestamp DESC
```
**åº”ç”¨åœºæ™¯**ï¼šå›ç­”"å®å¾·æ—¶ä»£æœ€è¿‘æœ‰ä»€ä¹ˆåŠ¨æ€ï¼Ÿ"ã€"èŒ…å°çš„è´¢åŠ¡æ•°æ®ï¼Ÿ"

#### å·¥å…· 3: å…³ç³»æ£€ç´¢ - `find_relationships`
```python
# æŸ¥æ‰¾ä¸¤ä¸ªå®ä½“ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼ˆå…³ç³»æ¨ç†ï¼‰
MATCH p = shortestPath(
  (e1:Entity {name: $n1})-[*]-(e2:Entity {name: $n2})
)
RETURN p
```
**åº”ç”¨åœºæ™¯**ï¼šå›ç­”"A å’Œ B æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"ã€"å¦‚ä½•ä» A å…³è”åˆ° Bï¼Ÿ"

### 2. å›¾å¢å¼ºæ£€ç´¢çš„ä¼˜åŠ¿

#### ä¼ ç»Ÿå‘é‡ RAG çš„é™åˆ¶
```python
# åªèƒ½åšç›¸ä¼¼åº¦æ£€ç´¢
query_vector = encode("å®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªçš„å…³ç³»")
results = vector_db.similarity_search(query_vector, k=5)
# âŒ é—®é¢˜ï¼šæ— æ³•ç†è§£"å…³ç³»"çš„å«ä¹‰ï¼Œåªèƒ½è¿”å›åŒ…å«è¿™ä¸¤ä¸ªè¯çš„æ–‡æ¡£
```

#### å›¾å¢å¼º RAG çš„å®ç°
```python
# èƒ½å¤Ÿè¿›è¡Œå…³ç³»æ¨ç†
cypher = """
MATCH p = shortestPath(
  (a:Entity {name: "å®å¾·æ—¶ä»£"})-[*]-(b:Entity {name: "æ¯”äºšè¿ª"})
)
RETURN p, relationships(p) as rels
"""
# âœ… ä¼˜åŠ¿ï¼šç›´æ¥è¿”å›å®ä½“é—´çš„è·¯å¾„å’Œå…³ç³»ç±»å‹
```

### 3. MCP åè®®é›†æˆ

é€šè¿‡ OpenAI Tool Calling å…¼å®¹åè®®ï¼ˆç±»ä¼¼ MCPï¼‰ï¼Œå®ç° LLM ä¸å›¾æ•°æ®åº“çš„äº¤äº’ï¼š

```python
TOOLS_SCHEMA = [
    {
        "type": "function",
        "function": {
            "name": "find_relationships",
            "description": "åˆ†æä¸¤ä¸ªå®ä½“ä¹‹é—´çš„å…³ç³»è·¯å¾„",
            "parameters": {
                "type": "object",
                "properties": {
                    "entity1": {"type": "string"},
                    "entity2": {"type": "string"}
                }
            }
        }
    }
]

# LLM è‡ªåŠ¨å†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·
response = client.chat.completions.create(
    model="qwen-max",
    messages=messages,
    tools=TOOLS_SCHEMA,  # æä¾›å·¥å…·å®šä¹‰
    tool_choice="auto"   # è®© LLM è‡ªä¸»å†³å®š
)
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰å‹ | ä½œç”¨ |
|------|---------|------|
| **æ£€ç´¢å±‚** | Neo4j | å›¾æ•°æ®åº“ï¼Œå­˜å‚¨ç»“æ„åŒ–çŸ¥è¯† |
| **LLM** | Qwen (DashScope) | ç”Ÿæˆæ¨¡å‹ + Tool Calling |
| **åè®®** | OpenAI Tool Calling | MCP å…¼å®¹çš„å·¥å…·è°ƒç”¨åè®® |
| **æ•°æ®æŠ½å–** | LLM + Transformers | ä»éç»“æ„åŒ–æ–‡æœ¬æŠ½å–ç»“æ„åŒ–äº‹ä»¶ |
| **æ•°æ®æº** | akshare | å®æ—¶è´¢ç»æ–°é—» |

## ğŸ“ é¡¹ç›®ç»“æ„

```
finance_graph_agent/
â”œâ”€â”€ ingest_service.py      # æ•°æ®æŠ½å–ä¸å›¾è°±æ„å»ºæœåŠ¡
â”œâ”€â”€ agent_client.py        # RAG Agent å®¢æˆ·ç«¯ï¼ˆå·¥å…·è°ƒç”¨ï¼‰
â”œâ”€â”€ mcp_server.py          # MCP å·¥å…·å®šä¹‰ï¼ˆæ£€ç´¢ç­–ç•¥ï¼‰
â”œâ”€â”€ database.py            # Neo4j è¿æ¥å±‚
â”œâ”€â”€ requirements.txt       
â””â”€â”€ README.md             
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨ Neo4jï¼ˆDocker æ–¹å¼ï¼‰
docker run -d \
  --name neo4j \
  -p 7474:7474 -p 7687:7687 \
  -e NEO4J_AUTH=neo4j/password \
  neo4j:latest
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# Neo4j
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password

# LLM API
DASHSCOPE_API_KEY=your_key
DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
LLM_MODEL=qwen-max
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# ç»ˆç«¯1: å¯åŠ¨æ•°æ®æŠ½å–æœåŠ¡ï¼ˆæ„å»ºçŸ¥è¯†å›¾è°±ï¼‰
python ingest_service.py

# ç»ˆç«¯2: å¯åŠ¨ RAG Agentï¼ˆæ”¯æŒå·¥å…·è°ƒç”¨ï¼‰
python agent_client.py
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: å…³ç³»æ¨ç†æŸ¥è¯¢

```bash
User: å®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ

Agent æ€è€ƒè¿‡ç¨‹:
  1. è¯†åˆ«å®ä½“: "å®å¾·æ—¶ä»£"ã€"æ¯”äºšè¿ª"
  2. è°ƒç”¨å·¥å…·: find_relationships(entity1="å®å¾·æ—¶ä»£", entity2="æ¯”äºšè¿ª")
  3. Neo4j æŸ¥è¯¢: æœ€çŸ­è·¯å¾„ç®—æ³•
  4. è¿”å›ç»“æœ: è·¯å¾„åŒ…å« [ç«äº‰å…³ç³»]ã€[åŒè¡Œä¸š]ã€[æŠ•èµ„å…³ç³»] ç­‰
  
Agent å›ç­”:
  æ ¹æ®çŸ¥è¯†å›¾è°±æŸ¥è¯¢ï¼Œå®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªä¹‹é—´å­˜åœ¨ä»¥ä¸‹å…³ç³»ï¼š
  - ç›´æ¥å…³ç³»ï¼šåŒå±é”‚ç”µæ± è¡Œä¸šï¼Œå­˜åœ¨ç«äº‰å…³ç³»
  - é—´æ¥å…³ç³»ï¼šéƒ½æŠ•èµ„äº†ä¸Šæ¸¸äº§ä¸šé“¾ï¼ˆå¦‚é”‚çŸ¿ã€æ­£æææ–™ï¼‰
  - å…³è”äº‹ä»¶ï¼šåœ¨å¤šä¸ªæ–°èƒ½æºæ±½è½¦é¡¹ç›®ä¸­åŒæ—¶å‡ºç°
```

### ç¤ºä¾‹ 2: æ—¶åºæ£€ç´¢

```bash
User: æœ€è¿‘æœ‰ä»€ä¹ˆé‡è¦çš„è´¢ç»äº‹ä»¶ï¼Ÿ

Agent:
  âš™ï¸ è°ƒç”¨å·¥å…·: get_latest_market_events(limit=5)
  ğŸ” æ‰§è¡Œ Cypher æŸ¥è¯¢...
  
  æ ¹æ®æœ€æ–°æ•°æ®ï¼Œæœ€è¿‘å‘ç”Ÿäº†ä»¥ä¸‹é‡è¦äº‹ä»¶ï¼š
  1. å®å¾·æ—¶ä»£å®£å¸ƒæŠ•èµ„100äº¿å»ºè®¾æ–°å·¥å‚ï¼ˆ2024-01-15ï¼‰
  2. èŒ…å°å‘å¸ƒä¸‰å­£åº¦è´¢æŠ¥ï¼Œå‡€åˆ©æ¶¦å¢é•¿15%ï¼ˆ2024-01-14ï¼‰
  ...
```

### ç¤ºä¾‹ 3: å®ä½“å†å²æ£€ç´¢

```bash
User: å®å¾·æ—¶ä»£æœ€è¿‘æœ‰ä»€ä¹ˆåŠ¨æ€ï¼Ÿ

Agent:
  âš™ï¸ è°ƒç”¨å·¥å…·: search_entity_history(entity_name="å®å¾·æ—¶ä»£")
  
  å®å¾·æ—¶ä»£æœ€è¿‘çš„åŠ¨æ€åŒ…æ‹¬ï¼š
  - 2024-01-15:å®£å¸ƒæŠ•èµ„100äº¿å»ºè®¾æ–°å·¥å‚ï¼ˆä¸»ä½“è§’è‰²ï¼‰
  - 2024-01-10: ä¸æŸå…¬å¸è¾¾æˆæˆ˜ç•¥åˆä½œï¼ˆä¸»ä½“è§’è‰²ï¼‰
  - 2024-01-05: å‘å¸ƒæ–°æŠ€æœ¯çªç ´ï¼ˆä¸»ä½“è§’è‰²ï¼‰
```

## ğŸ¨ æŠ€æœ¯äº®ç‚¹

### 1. å›¾æ£€ç´¢ vs å‘é‡æ£€ç´¢

**ä¼ ç»Ÿå‘é‡ RAG**ï¼š
- åªèƒ½åšè¯­ä¹‰ç›¸ä¼¼åº¦åŒ¹é…
- æ— æ³•ç†è§£å®ä½“å…³ç³»
- è¿”å›çš„æ˜¯æ–‡æ¡£ç‰‡æ®µï¼Œéœ€è¦ LLM è‡ªè¡Œç†è§£

**å›¾å¢å¼º RAGï¼ˆæœ¬é¡¹ç›®ï¼‰**ï¼š
- ç»“æ„åŒ–å­˜å‚¨ï¼šEvent + Entity + Relation
- å…³ç³»æ¨ç†ï¼šæ”¯æŒå¤šè·³æŸ¥è¯¢ã€æœ€çŸ­è·¯å¾„
- ç²¾ç¡®æ£€ç´¢ï¼šç›´æ¥è¿”å›ç»“æ„åŒ–å…³ç³»æ•°æ®

### 2. å¤šç»´åº¦æ£€ç´¢ç­–ç•¥

ç³»ç»Ÿæ”¯æŒä¸‰ç§æ£€ç´¢æ¨¡å¼ï¼Œå¯¹åº”ä¸åŒçš„æŸ¥è¯¢éœ€æ±‚ï¼š

| æ£€ç´¢æ¨¡å¼ | é€‚ç”¨åœºæ™¯ | Cypher æŸ¥è¯¢ç±»å‹ |
|---------|---------|----------------|
| **æ—¶åºæ£€ç´¢** | "æœ€è¿‘å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" | `ORDER BY timestamp` |
| **å®ä½“æ£€ç´¢** | "Aå…¬å¸çš„æƒ…å†µï¼Ÿ" | `WHERE name CONTAINS` |
| **å…³ç³»æ£€ç´¢** | "Aå’ŒBçš„å…³ç³»ï¼Ÿ" | `shortestPath()` |

### 3. MCP åè®®çš„ä¼˜åŠ¿

- **æ ‡å‡†åŒ–æ¥å£**ï¼šå·¥å…·å®šä¹‰éµå¾ªæ ‡å‡†æ ¼å¼ï¼Œæ˜“äºæ‰©å±•
- **LLM è‡ªä¸»å†³ç­–**ï¼šè®©æ¨¡å‹è‡ªå·±å†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·
- **çµæ´»ç»„åˆ**ï¼šæ”¯æŒå¤šå·¥å…·é“¾å¼è°ƒç”¨
- **æ˜“äºç»´æŠ¤**ï¼šå·¥å…·é€»è¾‘ä¸ LLM é€»è¾‘è§£è€¦

### 4. å®æ—¶çŸ¥è¯†æ›´æ–°

- æŒç»­ä»æ–°é—»æºæŠ½å–äº‹ä»¶
- è‡ªåŠ¨æ„å»ºçŸ¥è¯†å›¾è°±
- æ”¯æŒå¢é‡æ›´æ–°å’Œå»é‡
- æ—¶é—´æˆ³ç®¡ç†ï¼Œæ”¯æŒæ—¶åºæŸ¥è¯¢

## ğŸ“Š çŸ¥è¯†å›¾è°±æ¨¡å‹

### æ•°æ®æ¨¡å‹

```
(Entity {name: "å®å¾·æ—¶ä»£"})
    -[:PARTICIPATES_IN {role: "ä¸»ä½“"}]-> 
(Event {type: "æŠ•èµ„", trigger: "å®£å¸ƒ", timestamp: "2024-01-15"})
    <-[:PARTICIPATES_IN {role: "å®¢ä½“"}]- 
(Entity {name: "æ–°å·¥å‚"})

(Entity {name: "å®å¾·æ—¶ä»£"})
    -[:COMPETES_WITH]->
(Entity {name: "æ¯”äºšè¿ª"})
```

### æ£€ç´¢æŸ¥è¯¢ç¤ºä¾‹

```cypher
-- å…³ç³»è·¯å¾„æŸ¥è¯¢
MATCH p = shortestPath(
  (a:Entity {name: "å®å¾·æ—¶ä»£"})-[*]-(b:Entity {name: "æ¯”äºšè¿ª"})
)
RETURN [n in nodes(p) | labels(n)[0] + ':' + coalesce(n.name, n.type)] as path

-- å®ä½“å†å²æŸ¥è¯¢
MATCH (ent:Entity)-[r:PARTICIPATES_IN]->(e:Event)
WHERE ent.name CONTAINS "å®å¾·æ—¶ä»£"
RETURN e.timestamp, e.type, e.trigger, r.role
ORDER BY e.timestamp DESC

-- æ—¶åºæŸ¥è¯¢
MATCH (e:Event)
WHERE e.timestamp >= date() - duration({days: 7})
RETURN e
ORDER BY e.timestamp DESC
```

## ğŸ”¬ å¯¹æ¯”å®éªŒ

### æŸ¥è¯¢ï¼š"å®å¾·æ—¶ä»£å’Œæ¯”äºšè¿ªæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ"

**ä¼ ç»Ÿå‘é‡ RAG**ï¼š
```
æ£€ç´¢ç»“æœ: 
- "å®å¾·æ—¶ä»£æ˜¯é”‚ç”µæ± é¾™å¤´ä¼ä¸š..."
- "æ¯”äºšè¿ªä¹Ÿä»äº‹é”‚ç”µæ± ç”Ÿäº§..."
- "ä¸¤è€…åœ¨æ–°èƒ½æºæ±½è½¦é¢†åŸŸ..."

âŒ LLM éœ€è¦è‡ªè¡Œæ¨ç†å…³ç³»ï¼Œå¯èƒ½ä¸å‡†ç¡®
```

**æœ¬é¡¹ç›®çš„å›¾å¢å¼º RAG**ï¼š
```
Neo4j æŸ¥è¯¢ç»“æœ:
è·¯å¾„: å®å¾·æ—¶ä»£ -[COMPETES_WITH]-> æ¯”äºšè¿ª
è·¯å¾„: å®å¾·æ—¶ä»£ -[INVEST]-> Event -[INVEST]-> æ¯”äºšè¿ª

âœ… ç›´æ¥è¿”å›ç»“æ„åŒ–å…³ç³»ï¼ŒLLM ç›´æ¥ä½¿ç”¨
```

## ğŸ¯ é€‚ç”¨åœºæ™¯

- **é‡‘èé¢†åŸŸ**ï¼šå…¬å¸å…³ç³»åˆ†æã€äº‹ä»¶è¿½è¸ª
- **çŸ¥è¯†é—®ç­”**ï¼šéœ€è¦å…³ç³»æ¨ç†çš„å¤æ‚æŸ¥è¯¢
- **ä¼ä¸šå›¾è°±**ï¼šä¾›åº”é“¾ã€æŠ•èµ„å…³ç³»åˆ†æ
- **å­¦æœ¯ç ”ç©¶**ï¼šè®ºæ–‡å¼•ç”¨å…³ç³»ã€ä½œè€…åˆä½œç½‘ç»œ

## ğŸ”® æœªæ¥è§„åˆ’

- [ ] æ”¯æŒå‘é‡ + å›¾æ··åˆæ£€ç´¢ï¼ˆHybrid Searchï¼‰
- [ ] å®ç°æ›´å¤æ‚çš„å›¾ç®—æ³•ï¼ˆPageRankã€ç¤¾åŒºå‘ç°ï¼‰
- [ ] æ”¯æŒè‡ªç„¶è¯­è¨€åˆ° Cypher çš„è‡ªåŠ¨è½¬æ¢
- [ ] æ·»åŠ æŸ¥è¯¢ç»“æœç¼“å­˜å’Œä¼˜åŒ–
- [ ] æ”¯æŒæ›´å¤šæ•°æ®æºå’ŒçŸ¥è¯†æŠ½å–ç­–ç•¥
- [ ] Web ç•Œé¢å’Œå¯è§†åŒ–å±•ç¤º

## ğŸ“š ç›¸å…³æŠ€æœ¯

- [Neo4j Graph Database](https://neo4j.com/)
- [Retrieval-Augmented Generation (RAG)](https://arxiv.org/abs/2005.11401)
- [Model Context Protocol (MCP)](https://modelcontextprotocol.io/)
- [Graph Neural Networks](https://arxiv.org/abs/1812.08434)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ License

MIT License

## ğŸ‘¤ ä½œè€…

fu4geliu - [GitHub](https://github.com/fu4geliu) - [Email](mailto:3290854198@qq.com)

## ğŸ™ è‡´è°¢

- [akshare](https://github.com/akfamily/akshare) - é‡‘èæ•°æ®æ¥å£
- [Neo4j](https://neo4j.com/) - å›¾æ•°æ®åº“
- [Qwen](https://github.com/QwenLM/Qwen) - é€šä¹‰åƒé—®å¤§è¯­è¨€æ¨¡å‹
- [Transformers](https://huggingface.co/docs/transformers) - Hugging Faceæ¨¡å‹åº“

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼